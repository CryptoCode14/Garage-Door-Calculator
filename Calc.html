<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Garage Door Price Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .tab-button { transition: all 0.3s ease; }
        .tab-button.active { border-color: #3B82F6; background-color: #3B82F6; color: white; }
        .tab-button:not(.active):hover { background-color: #E5E7EB; }
        .input-field { border-color: #D1D5DB; }
        .input-field:focus { border-color: #3B82F6; box-shadow: 0 0 0 2px #BFDBFE; outline: none;}
        .output-field { background-color: #F3F4F6; font-weight: bold; }
        .section-title { border-bottom: 2px solid #3B82F6; padding-bottom: 0.5rem; margin-bottom: 1rem; color: #1E40AF; font-size: 1.25rem;}
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; }
        .form-group { display: flex; flex-direction: column; margin-bottom: 0.75rem; }
        .form-group label { margin-bottom: 0.25rem; color: #374151; font-size: 0.875rem; }
        .form-group input, .form-group select { padding: 0.5rem; border-radius: 0.375rem; border: 1px solid #D1D5DB; width: 100%; }
        .form-group .output-value { padding: 0.5rem; border-radius: 0.375rem; background-color: #E5E7EB; color: #1F2937; font-weight: 500; min-height: 38px; display: flex; align-items: center;}
        .summary-section { background-color: #EFF6FF; padding: 1rem; border-radius: 0.5rem; margin-top: 1.5rem; }
        .summary-section .form-group label { font-weight: 600; }
        .summary-section .output-value.grand-total { font-size: 1.25rem; color: #1E40AF; }
    </style>
</head>
<body class="bg-gray-100 p-4 md:p-8">

    <div class="container mx-auto max-w-5xl bg-white shadow-xl rounded-lg p-6 md:p-8">
        <header class="mb-6 text-center">
            <h1 class="text-3xl font-bold text-gray-800">Garage Door Price Calculator</h1>
        </header>

        <!-- Tabs Navigation -->
        <div class="mb-6 flex justify-center border-b border-gray-300">
            <button id="tab-commercial" class="tab-button active text-sm md:text-base font-medium py-3 px-6 border-b-2 border-transparent text-blue-600 hover:text-blue-800 focus:outline-none">Commercial</button>
            <button id="tab-residential" class="tab-button text-sm md:text-base font-medium py-3 px-6 border-b-2 border-transparent text-gray-500 hover:text-gray-700 focus:outline-none">Residential</button>
            <button id="tab-service" class="tab-button text-sm md:text-base font-medium py-3 px-6 border-b-2 border-transparent text-gray-500 hover:text-gray-700 focus:outline-none">Service Call</button>
        </div>

        <!-- Tab Content -->
        <div id="content-commercial" class="tab-content">
            <h2 class="section-title">Commercial Door Calculator</h2>
            <div class="grid-container">
                <!-- Door Components -->
                <div class="p-4 bg-blue-50 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-3 text-blue-700">Door Components Costs</h3>
                    <div class="form-group">
                        <label for="com_c11">Sections Cost:</label>
                        <input type="number" id="com_c11" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="com_c12">Windows / Lite Kit Cost:</label>
                        <input type="number" id="com_c12" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="com_c13">Insulation Cost:</label>
                        <input type="number" id="com_c13" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="com_c14">Perimeter Seal / Jamb Seal Cost:</label>
                        <input type="number" id="com_c14" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="com_c15">Inside Lock Cost:</label>
                        <input type="number" id="com_c15" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="com_c16">Struts Cost:</label>
                        <input type="number" id="com_c16" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>Subtotal Door Parts (C11:C16):</label>
                        <div id="com_calc_sum_c11_c16" class="output-field output-value">0.00</div>
                    </div>
                </div>

                <!-- Track, Spring, Misc Options -->
                <div class="p-4 bg-green-50 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-3 text-green-700">Track, Spring & Options</h3>
                    <div class="form-group">
                        <label for="com_c17_price">Track Price (C17):</label>
                        <input type="number" id="com_c17_price" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="com_a19_qty">Track Quantity (A19):</label>
                        <input type="number" id="com_a19_qty" class="input-field" placeholder="1" step="1">
                    </div>
                    <div class="form-group">
                        <label>Total Track Assembly (C17*A19):</label>
                        <div id="com_calc_c17_times_a19" class="output-field output-value">0.00</div>
                    </div>

                    <div class="form-group mt-4">
                        <label for="com_b21_price">Spring Price (B21):</label>
                        <input type="number" id="com_b21_price" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="com_a21_qty">Spring Quantity (A21):</label>
                        <input type="number" id="com_a21_qty" class="input-field" placeholder="1" step="1">
                    </div>
                    <div class="form-group">
                        <label>Total Spring Assembly (B21*A21):</label>
                        <div id="com_calc_b21_times_a21" class="output-field output-value">0.00</div>
                    </div>
                    
                    <div class="form-group mt-4">
                        <label for="com_a23_multiplier">Misc Options Multiplier (A23, applies to Track Total):</label>
                        <input type="number" id="com_a23_multiplier" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>Total Misc Options (Track Total * A23):</label>
                        <div id="com_calc_c19val_times_a23" class="output-field output-value">0.00</div>
                    </div>
                    <div class="form-group mt-2">
                        <label>Subtotal (Track + Spring + Misc Options):</label>
                        <div id="com_calc_sum_c19_c21_c23_results" class="output-field output-value">0.00</div>
                    </div>
                </div>

                <!-- Labor -->
                <div class="p-4 bg-yellow-50 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-3 text-yellow-700">Labor Costs</h3>
                    <div class="form-group"><label for="com_c25">Basic Install (C25):</label><input type="number" id="com_c25" class="input-field" placeholder="0.00" step="0.01"></div>
                    <div class="form-group"><label for="com_c26">High Lift/Vertical Lift (C26):</label><input type="number" id="com_c26" class="input-field" placeholder="0.00" step="0.01"></div>
                    <div class="form-group"><label for="com_c27">Opener Install (C27):</label><input type="number" id="com_c27" class="input-field" placeholder="0.00" step="0.01"></div>
                    <div class="form-group"><label for="com_c28">Removal/Disposal (C28):</label><input type="number" id="com_c28" class="input-field" placeholder="0.00" step="0.01"></div>
                    <div class="form-group"><label for="com_c29">Travel/Service Fee (C29):</label><input type="number" id="com_c29" class="input-field" placeholder="0.00" step="0.01"></div>
                    <div class="form-group"><label for="com_c30">Other Labor (C30):</label><input type="number" id="com_c30" class="input-field" placeholder="0.00" step="0.01"></div>
                    <div class="form-group">
                        <label>Subtotal Labor (C25:C30):</label>
                        <div id="com_calc_sum_c25_c30" class="output-field output-value">0.00</div>
                    </div>
                </div>
                
                <!-- Operator -->
                <div class="p-4 bg-indigo-50 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-3 text-indigo-700">Operator Costs</h3>
                    <div class="form-group">
                        <label for="com_c31_price_operator">Operator Price (C31):</label>
                        <input type="number" id="com_c31_price_operator" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="com_a33_qty_operator">Operator Quantity (A33):</label>
                        <input type="number" id="com_a33_qty_operator" class="input-field" placeholder="1" step="1">
                    </div>
                    <div class="form-group">
                        <label>Total Operator Cost (C31*A33):</label>
                        <div id="com_calc_c31val_times_a33" class="output-field output-value">0.00</div>
                    </div>
                     <div class="form-group mt-2">
                        <label>Total Labor + Operator (Formula C31+C33):</label>
                        <div id="com_calc_sum_c31_plus_c33_results" class="output-field output-value">0.00</div>
                    </div>
                </div>
            </div>

            <!-- Commercial Summary & Totals -->
            <div class="summary-section mt-6">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Commercial Quote Summary</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="form-group"><label>Total Door Components Cost:</label><div id="com_total_door_components_cost" class="output-field output-value">0.00</div></div>
                    <div class="form-group"><label>Total Track, Spring, Options (Formula Subtotal):</label><div id="com_total_track_spring_options_cost" class="output-field output-value">0.00</div></div>
                    <div class="form-group"><label>Total Labor Cost:</label><div id="com_total_labor_cost_summary" class="output-field output-value">0.00</div></div>
                    <div class="form-group"><label>Total Operator Cost:</label><div id="com_total_operator_cost_summary" class="output-field output-value">0.00</div></div>
                    <div class="form-group col-span-full md:col-span-1"><label>Total Direct Job Costs:</label><div id="com_total_direct_job_costs" class="output-field output-value text-lg">0.00</div></div>
                    
                    <div class="form-group">
                        <label for="com_markup_percentage">Markup Percentage (%):</label>
                        <input type="number" id="com_markup_percentage" class="input-field" placeholder="0" step="0.01">
                    </div>
                    <div class="form-group"><label>Markup Amount:</label><div id="com_markup_amount" class="output-field output-value">0.00</div></div>
                    <div class="form-group"><label>Subtotal Before Tax (C35 - Selling Price):</label><div id="com_subtotal_before_tax" class="output-field output-value text-lg">0.00</div></div>
                    
                    <div class="form-group">
                        <label for="com_tax_rate">Tax Rate (%):</label>
                        <input type="number" id="com_tax_rate" class="input-field" placeholder="0" step="0.01">
                    </div>
                    <div class="form-group"><label>Tax Amount:</label><div id="com_tax_amount" class="output-field output-value">0.00</div></div>
                    <div class="form-group col-span-full md:col-span-1"><label>Grand Total:</label><div id="com_grand_total" class="output-field output-value grand-total text-xl">0.00</div></div>
                </div>
            </div>
            
            <!-- Specific Profit Calculation (Commercial) -->
            <div class="summary-section mt-6 bg-purple-50">
                 <h3 class="text-xl font-semibold mb-4 text-purple-700">Specific Profit Calculation (Formulas C35-C40)</h3>
                 <p class="text-sm text-purple-600 mb-2">This section uses specific formulas: C37 = Track Total + Spring Total. C39 = C35 (Subtotal Before Tax) - C37. C40 = (C39/C35)*100.</p>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="form-group"><label>Cost for Profit Calc (C37 = Track + Spring):</label><div id="com_cost_for_profit_calc_c37" class="output-field output-value">0.00</div></div>
                    <div class="form-group"><label>Profit (C39 = C35 - C37):</label><div id="com_profit_c39" class="output-field output-value">0.00</div></div>
                    <div class="form-group col-span-full md:col-span-1"><label>Profit Margin (C40 = (C39/C35)*100%):</label><div id="com_profit_margin_c40" class="output-field output-value">0.00%</div></div>
                </div>
            </div>
        </div>

        <div id="content-residential" class="tab-content hidden">
            <h2 class="section-title">Residential Door Calculator</h2>
            <p class="text-gray-600">Residential calculator fields will be similar to commercial. This section is a placeholder and will use the same logic structure. You can duplicate and adjust commercial fields and IDs (e.g., `res_c11` instead of `com_c11`).</p>
            <!-- Residential Fields will go here, mirroring commercial structure with 'res_' prefix -->
            <!-- For brevity, I'm not duplicating all fields here, but they would follow the commercial pattern -->
            <div class="p-4 bg-blue-50 rounded-lg shadow mb-4">
                <h3 class="text-lg font-semibold mb-3 text-blue-700">Door Components Costs</h3>
                <div class="form-group">
                    <label for="res_c11">Sections Cost:</label>
                    <input type="number" id="res_c11" class="input-field" placeholder="0.00" step="0.01">
                </div>
                </div>
             <div class="summary-section mt-6">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Residential Quote Summary</h3>
                 <div class="form-group"><label>Grand Total:</label><div id="res_grand_total" class="output-field output-value grand-total text-xl">0.00</div></div>
            </div>
        </div>

        <div id="content-service" class="tab-content hidden">
            <h2 class="section-title">Service Call Calculator</h2>
            <div class="grid-container">
                <div class="p-4 bg-teal-50 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-3 text-teal-700">Service Call Details</h3>
                    <div class="form-group">
                        <label for="sc_service_call_fee">Base Service Call Fee:</label>
                        <input type="number" id="sc_service_call_fee" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="sc_labor_hours">Labor Hours:</label>
                        <input type="number" id="sc_labor_hours" class="input-field" placeholder="0" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="sc_labor_rate_per_hour">Labor Rate per Hour:</label>
                        <input type="number" id="sc_labor_rate_per_hour" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>Total Labor Cost:</label>
                        <div id="sc_total_labor_cost" class="output-field output-value">0.00</div>
                    </div>
                    <div class="form-group">
                        <label for="sc_total_parts_cost">Total Cost of Parts Used:</label>
                        <input type="number" id="sc_total_parts_cost" class="input-field" placeholder="0.00" step="0.01">
                    </div>
                </div>
            </div>
            <div class="summary-section mt-6">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Service Call Summary</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="form-group"><label>Subtotal Before Tax:</label><div id="sc_subtotal_before_tax" class="output-field output-value">0.00</div></div>
                    <div class="form-group">
                        <label for="sc_tax_rate">Tax Rate (%):</label>
                        <input type="number" id="sc_tax_rate" class="input-field" placeholder="0" step="0.01">
                    </div>
                    <div class="form-group"><label>Tax Amount:</label><div id="sc_tax_amount" class="output-field output-value">0.00</div></div>
                    <div class="form-group col-span-full md:col-span-1"><label>Grand Total:</label><div id="sc_grand_total" class="output-field output-value grand-total text-xl">0.00</div></div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
```javascript
// script.js
document.addEventListener('DOMContentLoaded', () => {
    // Tab switching logic
    const tabs = [
        { button: document.getElementById('tab-commercial'), content: document.getElementById('content-commercial') },
        { button: document.getElementById('tab-residential'), content: document.getElementById('content-residential') },
        { button: document.getElementById('tab-service'), content: document.getElementById('content-service') }
    ];

    tabs.forEach(tab => {
        if (tab.button) {
            tab.button.addEventListener('click', () => {
                tabs.forEach(t => {
                    t.button.classList.remove('active', 'text-blue-600');
                    t.button.classList.add('text-gray-500', 'hover:text-gray-700');
                    if (t.content) t.content.classList.add('hidden');
                });
                tab.button.classList.add('active', 'text-blue-600');
                tab.button.classList.remove('text-gray-500', 'hover:text-gray-700');
                if (tab.content) tab.content.classList.remove('hidden');
                // Trigger calculation for the newly active tab
                if (tab.button.id === 'tab-commercial') calculateCommercial();
                if (tab.button.id === 'tab-residential') calculateResidential();
                if (tab.button.id === 'tab-service') calculateServiceCall();
            });
        }
    });

    // Helper to get numeric value from input
    function getNumValue(id, defaultValue = 0) {
        const element = document.getElementById(id);
        if (!element) {
            console.warn(`Element with ID ${id} not found.`);
            return defaultValue;
        }
        const value = parseFloat(element.value);
        return isNaN(value) ? defaultValue : value;
    }

    // Helper to set text content of an element
    function setText(id, value, isCurrency = true, decimals = 2) {
        const element = document.getElementById(id);
        if (!element) {
            console.warn(`Element with ID ${id} not found for setting text.`);
            return;
        }
        if (isCurrency) {
            element.textContent = parseFloat(value).toFixed(decimals);
        } else {
            element.textContent = value;
        }
    }
    
    function formatCurrency(value, decimals = 2) {
        return parseFloat(value).toFixed(decimals);
    }

    function formatPercentage(value, decimals = 2) {
        return parseFloat(value).toFixed(decimals) + '%';
    }


    // --- Commercial Calculator Logic ---
    function calculateCommercial() {
        // Door Components (C11:C16)
        const com_c11 = getNumValue('com_c11');
        const com_c12 = getNumValue('com_c12');
        const com_c13 = getNumValue('com_c13');
        const com_c14 = getNumValue('com_c14');
        const com_c15 = getNumValue('com_c15');
        const com_c16 = getNumValue('com_c16');
        const com_calc_sum_c11_c16 = com_c11 + com_c12 + com_c13 + com_c14 + com_c15 + com_c16;
        setText('com_calc_sum_c11_c16', com_calc_sum_c11_c16);

        // Track Assembly (C17*A19)
        const com_c17_price = getNumValue('com_c17_price');
        const com_a19_qty = getNumValue('com_a19_qty', 1); // Default qty to 1 if not set
        const com_calc_c17_times_a19 = com_c17_price * com_a19_qty;
        setText('com_calc_c17_times_a19', com_calc_c17_times_a19);

        // Spring Assembly (B21*A21)
        const com_b21_price = getNumValue('com_b21_price');
        const com_a21_qty = getNumValue('com_a21_qty', 1); // Default qty to 1
        const com_calc_b21_times_a21 = com_b21_price * com_a21_qty;
        setText('com_calc_b21_times_a21', com_calc_b21_times_a21);

        // Misc Options (C19val * A23 where C19val is Total Track Assembly)
        const com_a23_multiplier = getNumValue('com_a23_multiplier');
        const com_calc_c19val_times_a23 = com_calc_c17_times_a19 * com_a23_multiplier;
        setText('com_calc_c19val_times_a23', com_calc_c19val_times_a23);
        
        // Subtotal (Track + Spring + Misc Options) (Formula C19+C21+C23)
        const com_calc_sum_c19_c21_c23_results = com_calc_c17_times_a19 + com_calc_b21_times_a21 + com_calc_c19val_times_a23;
        setText('com_calc_sum_c19_c21_c23_results', com_calc_sum_c19_c21_c23_results);

        // Labor Costs (C25:C30)
        const com_c25 = getNumValue('com_c25');
        const com_c26 = getNumValue('com_c26');
        const com_c27 = getNumValue('com_c27');
        const com_c28 = getNumValue('com_c28');
        const com_c29 = getNumValue('com_c29');
        const com_c30 = getNumValue('com_c30');
        const com_calc_sum_c25_c30 = com_c25 + com_c26 + com_c27 + com_c28 + com_c29 + com_c30;
        setText('com_calc_sum_c25_c30', com_calc_sum_c25_c30);

        // Operator Costs (C31*A33)
        const com_c31_price_operator = getNumValue('com_c31_price_operator');
        const com_a33_qty_operator = getNumValue('com_a33_qty_operator', 1); // Default qty to 1
        const com_calc_c31val_times_a33 = com_c31_price_operator * com_a33_qty_operator;
        setText('com_calc_c31val_times_a33', com_calc_c31val_times_a33);

        // Total Labor + Operator (Formula SUM(C31+C33) where C31 is labor sum, C33 is operator total)
        const com_calc_sum_c31_plus_c33_results = com_calc_sum_c25_c30 + com_calc_c31val_times_a33;
        setText('com_calc_sum_c31_plus_c33_results', com_calc_sum_c31_plus_c33_results);
        
        // Summary Calculations
        const com_total_door_components_cost = com_calc_sum_c11_c16;
        setText('com_total_door_components_cost', com_total_door_components_cost);

        // This is the sum of Track, Spring, and Misc Options based on C19+C21+C23 formula
        const com_total_track_spring_options_cost = com_calc_sum_c19_c21_c23_results;
        setText('com_total_track_spring_options_cost', com_total_track_spring_options_cost);
        
        const com_total_labor_cost_summary = com_calc_sum_c25_c30;
        setText('com_total_labor_cost_summary', com_total_labor_cost_summary);
        
        const com_total_operator_cost_summary = com_calc_c31val_times_a33;
        setText('com_total_operator_cost_summary', com_total_operator_cost_summary);

        const com_total_direct_job_costs = com_total_door_components_cost + com_total_track_spring_options_cost + com_total_labor_cost_summary + com_total_operator_cost_summary;
        setText('com_total_direct_job_costs', com_total_direct_job_costs);

        const com_markup_percentage = getNumValue('com_markup_percentage');
        const com_markup_amount = com_total_direct_job_costs * (com_markup_percentage / 100);
        setText('com_markup_amount', com_markup_amount);

        const com_subtotal_before_tax = com_total_direct_job_costs + com_markup_amount; // This is C35
        setText('com_subtotal_before_tax', com_subtotal_before_tax);

        const com_tax_rate = getNumValue('com_tax_rate');
        const com_tax_amount = com_subtotal_before_tax * (com_tax_rate / 100);
        setText('com_tax_amount', com_tax_amount);

        const com_grand_total = com_subtotal_before_tax + com_tax_amount;
        setText('com_grand_total', com_grand_total);

        // Specific Profit Calculation (Formulas C35-C40)
        // C37 = Total Track Assembly (com_calc_c17_times_a19) + Total Spring Assembly (com_calc_b21_times_a21)
        // This matches user formula SUM(C19+C21) if C19 is track total and C21 is spring total
        const com_cost_for_profit_calc_c37 = com_calc_c17_times_a19 + com_calc_b21_times_a21;
        setText('com_cost_for_profit_calc_c37', com_cost_for_profit_calc_c37);

        // C35 is com_subtotal_before_tax
        const com_profit_c39 = com_subtotal_before_tax - com_cost_for_profit_calc_c37;
        setText('com_profit_c39', com_profit_c39);

        let com_profit_margin_c40 = 0;
        if (com_subtotal_before_tax !== 0) {
            com_profit_margin_c40 = (com_profit_c39 / com_subtotal_before_tax) * 100;
        }
        setText('com_profit_margin_c40', formatPercentage(com_profit_margin_c40), false);
    }

    // --- Residential Calculator Logic ---
    function calculateResidential() {
        // Placeholder: Implement residential calculations similar to commercial
        // For now, just calculate a dummy grand total if some fields exist
        const res_c11 = getNumValue('res_c11'); // Example field
        // ... more fields and calculations
        const res_grand_total = res_c11 * 1.25; // Dummy calculation
        setText('res_grand_total', res_grand_total);
        console.log("Residential calculation triggered. Grand Total (dummy):", res_grand_total);
         // TODO: Fully implement residential calculations by:
        // 1. Adding all corresponding HTML fields in the Residential tab (similar to Commercial but with 'res_' prefix).
        // 2. Duplicating the logic from calculateCommercial(), changing 'com_' prefixes to 'res_'.
        // 3. Adjusting any specific formulas or fields unique to residential quotes.
    }

    // --- Service Call Calculator Logic ---
    function calculateServiceCall() {
        const sc_service_call_fee = getNumValue('sc_service_call_fee');
        const sc_labor_hours = getNumValue('sc_labor_hours');
        const sc_labor_rate_per_hour = getNumValue('sc_labor_rate_per_hour');
        const sc_total_parts_cost = getNumValue('sc_total_parts_cost');

        const sc_total_labor_cost = sc_labor_hours * sc_labor_rate_per_hour;
        setText('sc_total_labor_cost', sc_total_labor_cost);

        const sc_subtotal_before_tax = sc_service_call_fee + sc_total_labor_cost + sc_total_parts_cost;
        setText('sc_subtotal_before_tax', sc_subtotal_before_tax);

        const sc_tax_rate = getNumValue('sc_tax_rate');
        const sc_tax_amount = sc_subtotal_before_tax * (sc_tax_rate / 100);
        setText('sc_tax_amount', sc_tax_amount);

        const sc_grand_total = sc_subtotal_before_tax + sc_tax_amount;
        setText('sc_grand_total', sc_grand_total);
    }

    // Attach event listeners to all input fields for dynamic calculation
    const allInputs = document.querySelectorAll('.input-field');
    allInputs.forEach(input => {
        input.addEventListener('input', () => {
            const activeTabButton = tabs.find(tab => tab.button && tab.button.classList.contains('active'));
            if (activeTabButton) {
                if (activeTabButton.button.id === 'tab-commercial') calculateCommercial();
                if (activeTabButton.button.id === 'tab-residential') calculateResidential();
                if (activeTabButton.button.id === 'tab-service') calculateServiceCall();
            }
        });
    });

    // Initial calculation for the default active tab (Commercial)
    if (document.getElementById('tab-commercial')?.classList.contains('active')) {
        calculateCommercial();
    }
});
